---
title: "Street or Road"
author: "Suzanne Papik"
date: "11/8/17"
output: 
  html_document:
    fig_height: 3
    fig_width: 5
---
<!-- Don't edit in between this line and the one below -->
```{r include=FALSE}
# Don't delete this chunk if you are using the DataComputing package
library(DataComputing)
library(tidyr)
library(readr)
```
*Source file* 
```{r, results='asis', echo=FALSE}
includeSourceDocuments()
```
<!-- Don't edit the material above this line -->


```{r}
Addresses <-
  read_csv("~/street-addresses.csv")
```
```{r}
Sample<-Addresses %>% 
  sample_n(size=50)

Matches <- 
  Sample %>% 
  filter(grepl("PO",address))
Dont <- 
  Sample %>%
  filter(!grepl("PO",address))

pattern <- "BOX\\s+(\\d+)"
Matches <- 
  Sample %>%
  filter(grepl(pattern,address))
Dont<- 
  Sample %>% 
  filter(!grepl(pattern,address))

BoxNumbers <- Sample %>% 
  filter(grepl(pattern,address)) %>%
  tidyr::extract(address,into="boxnum",regex=pattern)
```

```{r}
#The first line in filter filters out all the addresses that have the strings in pattern, which are ST, RD, and ROAD. The second line filters out all the addresses with APT or UNIT in the name. The third line filters out any addresses with BOX in it. 
Pattern<-"(ST|RD|ROAD)"
LeftOvers<- 
  Addresses %>% 
  filter(! grepl(Pattern,address),
         ! grepl("\\sAPT|UNIT\\s[\\d]+$",address),
         ! grepl("BOX",address))
```

```{r}
Pattern2<-"(ST|RD|ROAD|CIRCLE|WAY|UNIVERSITY|COURT|CT|DR|LN|LANE|AVE|AVENUE|HALL|CIR|PLACE|PL|BX|PKWY|HWY|BLVD)"
LeftOvers<- 
  Addresses %>%
  filter(!grepl(Pattern2,address),
         !grepl("\\sAPT|UNIT\\s[\\d]+$",address),
         !grepl("BOX",address))
List1<-
  Addresses %>% 
  extractMatches(Pattern2,address) %>% 
  filter(grepl(Pattern2,address))

Full<-
  List1 %>% 
  group_by(match1) %>% 
  summarise(count=n()) %>% 
  arrange(desc(count))
Full
ggplot(data=Full,aes(x=reorder(match1,count),y=count ))+geom_bar(stat='identity',position='stack', width=.9)+coord_flip()+xlab("Street Ending") 